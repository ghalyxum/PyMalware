## Stage Clipboard
import ctypes
import subprocess




class Clipboard:
    def __init__(self):
        self.kernel32 = ctypes.windll.kernel32
        self.kernel32.GlobalLock.argtypes = [ctypes.c_void_p]
        self.kernel32.GlobalLock.restype = ctypes.c_void_p
        self.kernel32.GlobalUnlock.argtypes = [ctypes.c_void_p]
        
        self.user32 = ctypes.windll.user32
        self.user32.GetClipboardData.restype = ctypes.c_void_p
    
    def get_text(self):
        self.user32.OpenClipboard(0)
        if self.user32.IsClipboardFormatAvailable(1):
            data  = self.user32.GetClipboardData(1)
            data_locked = self.kernel32.GlobalLock(data)
            text = ctypes.c_char_p(data_locked)
            value = text.value
            self.kernel32.GlobalUnlock(data_locked)
            
            try:
                return value.decode()
            
            except Exception as e:
                return ''
        self.user32.CloseClipboard()

    def set_text(self,text):
        return subprocess.check_call(f'echo {text} |clip', shell=True)


    


## test

myClipboard = Clipboard()

myClipboard.set_text("YoYo clipboard stealer at here")
print(myClipboard.get_text())



